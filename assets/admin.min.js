!function (e) { "use strict"; e(document).ready(() => { function t(t = "", n = "", i = "", a = "") { let l = `<tr><td><input class="lb-weight-input" type="number" min="0" name="_min_weight[]" value="${t}"><span>gramas</span></td><td><b>at\xe9</b></td><td><input class="lb-weight-input" type="number" min="0" name="_max_weight[]" value="${n}"><span>gramas</span></td><td><input class="lb-weight-input" type="number" min="0" name="_max_size[]" value="${a}"><span>cm</span></td><td><b>EUR</b><input class="lb-weight-input" type="number" min="0" step="any" name="_min_price[]" value="${i}"></td><td><button class="lb-weight-delete" type="button">Deletar</button></tr>`; e("#lb-tradeinn-weight-settings tbody").append(l) } e(document).on("click", "#lb-tradeinn-new-line", t), e(document).on("click", ".lb-weight-delete", function t() { let n = e(this).parents("tr"); n.remove() }); let n = lb_tradeinn_crawler.selected_categories || [], i = lb_tradeinn_crawler.viewed_categories || [], a = lb_tradeinn_crawler.override_weight || [], l = lb_tradeinn_crawler.categories_weight || {}, s = lb_tradeinn_crawler.categories_dimension || {}, c = e => e && l[e] ? l[e] : "", r = e => e && s[e] ? s[e] : "", o = e => e.toLowerCase().trim().replace(/[^\w\s-]/g, "").replace(/[\s_-]+/g, "-").replace(/^-+|-+$/g, ""), d = t => { let n = e(t), i = []; return n.each(function () { let t = e(this).val(); "" !== t && -1 === i.indexOf(t) && i.push(t) }), i }; function u(t) { alert("Erro: " + t), e("#tradeinn-categories").prop("disabled", !1), e("#lb-tradeinn-save-categories").prop("disabled", !1), e("#lb-tradeinn-save-categories").html("Salvar") } e(document).on("change", ".lb-tradeinn-title", function t() { e(this).parent().parent().find('.lb-tradeinn-subitems li label[id^="lb-tradeinn-item"] input').prop("checked", this.checked) }), e(document).on("click", ".lb-tradeinn-toggle", function t() { e(this).parent().parent().children(".lb-tradeinn-subitems").slideToggle() }), e(document).on("submit", "#tradeinn-categories", function (t) { t.preventDefault(), e("#tradeinn-categories").prop("disabled", !0), e("#lb-tradeinn-save-categories").html("Aguarde"), e("#lb-tradeinn-save-categories").prop("disabled", !0), function t() { let n = d('input[name="sel_cat[]"]:checked'); e.ajax({ type: "POST", url: lb_tradeinn_crawler.ajaxurl, data: { categories: n, action: "process_selected_categories", nonce: lb_tradeinn_crawler.nonce }, dataType: "JSON", success: function () { (function t() { let n = d('input[name="vw_cat[]"]:checked'); e.ajax({ type: "POST", url: lb_tradeinn_crawler.ajaxurl, data: { viewed: n, action: "process_viewed_categories", nonce: lb_tradeinn_crawler.nonce }, dataType: "JSON", success: function () { (function t() { let n = d('input[name="ow_cat[]"]:checked'); e.ajax({ type: "POST", url: lb_tradeinn_crawler.ajaxurl, data: { overrides: n, action: "process_override_weight_categories", nonce: lb_tradeinn_crawler.nonce }, dataType: "JSON", success: function () { (function t() { let n = {}; e('input[name^="lt_dim["]').each(function () { let t = e(this).attr("name"), i = e(this).val(), a = /\[([^[\]]+)\]/.exec(t); if (a && i) { let l = a[1]; n[l] = i } }), e.ajax({ type: "POST", url: lb_tradeinn_crawler.ajaxurl, data: { dimensions: n, action: "process_categories_dimension", nonce: lb_tradeinn_crawler.nonce }, dataType: "JSON", success: function () { (function t() { let n = {}; e('input[name^="lt_wei["]').each(function () { let t = e(this).attr("name"), i = e(this).val(), a = /\[([^[\]]+)\]/.exec(t); if (a && i) { let l = a[1]; n[l] = i } }), e.ajax({ type: "POST", url: lb_tradeinn_crawler.ajaxurl, data: { weights: n, action: "process_categories_weight", nonce: lb_tradeinn_crawler.nonce }, dataType: "JSON", success: function () { location.reload() }, error: function (e, t, n) { u(n) } }) })() }, error: function (e, t, n) { u(n) } }) })() }, error: function (e, t, n) { u(n) } }) })() }, error: function (e, t, n) { u(n) } }) })() }, error: function (e, t, n) { u(n) } }) }() }), function e() { if (lb_tradeinn_crawler && lb_tradeinn_crawler.weight_settings && lb_tradeinn_crawler.weight_settings.length > 0) { lb_tradeinn_crawler.weight_settings.map(e => t(e.min_weight, e.max_weight, e.min_price, e.max_size || "")); return } t() }(), function t() { if (lb_tradeinn_crawler && lb_tradeinn_crawler.available_categories) { let l = lb_tradeinn_crawler.available_categories, s = (t, l, d) => { t.map(t => { let u = `${l}${l ? "-" : ""}${o(t.name)}`, p = !!t.childs && t.childs.length > 0, b = l ? `#lb-tradeinn-item_${l} ~ .lb-tradeinn-subitems` : ""; (function t(l, s, o = "", d = "", u = !0, p = !0) { let b, g; if (d) { let m = d.split("|"); b = m.shift(), g = m.pop() } else d = l; let h = `<li><label id="lb-tradeinn-item_${l}"><input type="checkbox" name="sel_cat[]" value="${d}" ${d && n.includes(d) ? "checked" : ""} ${u ? 'class="lb-tradeinn-title"' : ""}> ${p ? s : `<a href="https://tradeinn.com/${b}/pt/-/${g}/s" target="_blank">${s}</a>`} ${u && p ? '<button class="lb-tradeinn-toggle" type="button">Exibir/Ocultar</button>' : ""}</label>${u && p ? '<ul class="lb-tradeinn-subitems"></ul>' : ""} ${p ? "" : `<div style="display:inline-flex;gap:5px;align-items:center;"> <div><input type="checkbox" name="vw_cat[]" value="${d}" ${d && i.includes(d) ? "checked" : ""}></div> <label><strong>Peso (g): </strong><input type="number" name="lt_wei[${d}]" style="width: 70px" min="0" step="any" value="${c(d)}"></label> <label><strong>Dimens\xe3o (cm): </strong><input type="number" name="lt_dim[${d}]" style="width: 70px" min="0" step="any" value="${r(d)}"></label> <label><input type="checkbox" name="ow_cat[]" value="${d}" ${d && a.includes(d) ? "checked" : ""}> Usar Peso?</label> </div>`} </li>`; e(`#lb-tradeinn-available-categories ${o}`).append(h) })(u, t.name, b, p ? "" : `${d}|${t.id}`, p, p), p && s(t.childs, u, d ? `${d}|${t.id}` : `${t.name}|${t.id}`) }) }; if (!l.length) { e("#lb-tradeinn-save-categories").prop("disabled", !0); return } s(l, "", ""), e(".lb-tradeinn-subitems").slideToggle() } else e("#lb-tradeinn-save-categories").prop("disabled", !0) }() }) }(jQuery);